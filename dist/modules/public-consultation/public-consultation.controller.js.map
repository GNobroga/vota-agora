{"version":3,"sources":["../../../src/modules/public-consultation/public-consultation.controller.ts"],"sourcesContent":["import { Body, Controller, Delete, Get, HttpCode, HttpStatus, Param, Post, Put, UseGuards, UsePipes, ValidationPipe } from \"@nestjs/common\";\r\nimport { PaginatorDecorator } from \"src/core/decorators/paginator.decorator\";\r\nimport { RoleType } from \"src/core/enums/role-type.enum\";\r\nimport Paginator from \"src/core/models/Paginator\";\r\nimport { AllowRoles } from \"../auth/decorators/allow-roles.decorator\";\r\nimport AuthGuard from \"../auth/guards/auth.guard\";\r\nimport RoleGuard from \"../auth/guards/role.guard\";\r\nimport CreatePublicConsultationUseCase from \"./usecases/create-public-consultation.usecase\";\r\nimport FindAllPublicConsultationUseCase from \"./usecases/find-all-public-consultation.usecase\";\r\nimport CreatePublicConsultationRequestDTO from \"./dtos/request/create-public-consultation-request.dto\";\r\nimport { AuthUser } from \"../auth/decorators/auth-user.decorator\";\r\nimport { IAuthUser } from \"../auth/auth-user.interface\";\r\nimport UpdatePublicConsultationRequestDTO from \"./dtos/request/update-public-consultation-request.dto\";\r\nimport UpdatePublicConsultationUseCase from \"./usecases/update-public-consultation.usecase\";\r\nimport DeletePublicConsultationUseCase from \"./usecases/delete-public-consultation-by-id.usecase\";\r\nimport RegisterVotePublicConsultationUseCase from \"./usecases/register-vote-public-consultation.usecase\";\r\n\r\n\r\n@UseGuards(AuthGuard, RoleGuard)\r\n@AllowRoles(RoleType.USER, RoleType.ADMIN)\r\n@Controller({ path: 'public-consultations', version: '1' })\r\nexport default class PublicConsultationController {\r\n\r\n    constructor(\r\n        private readonly _createPublicConsultationUseCase: CreatePublicConsultationUseCase,\r\n        private readonly _findAllPublicConsultationUsecase: FindAllPublicConsultationUseCase,\r\n        private readonly _updatePublicConsultationUseCase: UpdatePublicConsultationUseCase,\r\n        private readonly _deletePublicConsultationUseCase: DeletePublicConsultationUseCase,\r\n        private readonly _registerVotePublicConsultationUseCase: RegisterVotePublicConsultationUseCase\r\n    ) {}\r\n\r\n    @Post()\r\n    @HttpCode(HttpStatus.CREATED)\r\n    @UsePipes(ValidationPipe)\r\n    async create(@Body() request: CreatePublicConsultationRequestDTO, @AuthUser() authUser: IAuthUser) {\r\n        console.log(authUser)\r\n        await this._createPublicConsultationUseCase.execute({\r\n            ...request,\r\n            userDocument: authUser.document,\r\n        });\r\n    }\r\n\r\n    @Put()\r\n    @AllowRoles(RoleType.ADMIN)\r\n    @HttpCode(HttpStatus.OK)\r\n    @UsePipes(ValidationPipe)\r\n    async update(@Body() request: UpdatePublicConsultationRequestDTO) {\r\n        return await this._updatePublicConsultationUseCase.execute(request);\r\n    }\r\n\r\n    @Delete(\":id\")\r\n    @HttpCode(HttpStatus.OK)\r\n    async deleteById(@Param(\"id\") identifier: string) {\r\n        return await this._deletePublicConsultationUseCase.execute(identifier);\r\n    }\r\n\r\n    @Get()\r\n    @HttpCode(HttpStatus.OK)\r\n    async findAll(@PaginatorDecorator() paginator: Paginator) {\r\n        return this._findAllPublicConsultationUsecase.execute(paginator);\r\n    }\r\n\r\n    @Get(\"register-vote/:id\")\r\n    @HttpCode(HttpStatus.OK)\r\n    async registerVote(@Param(\"id\") publicConsultationId: string, @AuthUser() authUser: IAuthUser) {\r\n        return await this._registerVotePublicConsultationUseCase.execute({\r\n            publicConsultationId,\r\n            userDocument: authUser.document,\r\n        });\r\n    }\r\n}"],"names":["PublicConsultationController","create","request","authUser","console","log","_createPublicConsultationUseCase","execute","userDocument","document","update","_updatePublicConsultationUseCase","deleteById","identifier","_deletePublicConsultationUseCase","findAll","paginator","_findAllPublicConsultationUsecase","registerVote","publicConsultationId","_registerVotePublicConsultationUseCase","constructor","CREATED","ADMIN","OK","USER","path","version"],"mappings":";;;;;;;eAqBqBA;;;wBArBsG;oCACxF;8BACV;kEACH;qCACK;kEACL;kEACA;wFACsB;yFACC;2FACE;mCACtB;mCACC;2FACqB;wFACH;4FACA;8FACM;;;;;;;;;;;;;;;;;;;;AAMnC,IAAA,AAAMA,+BAAN,MAAMA;IAUjB,MAGMC,OAAO,AAAQC,OAA2C,EAAE,AAAYC,QAAmB,EAAE;QAC/FC,QAAQC,GAAG,CAACF;QACZ,MAAM,IAAI,CAACG,gCAAgC,CAACC,OAAO,CAAC;YAChD,GAAGL,OAAO;YACVM,cAAcL,SAASM,QAAQ;QACnC;IACJ;IAEA,MAIMC,OAAO,AAAQR,OAA2C,EAAE;QAC9D,OAAO,MAAM,IAAI,CAACS,gCAAgC,CAACJ,OAAO,CAACL;IAC/D;IAEA,MAEMU,WAAW,AAAaC,UAAkB,EAAE;QAC9C,OAAO,MAAM,IAAI,CAACC,gCAAgC,CAACP,OAAO,CAACM;IAC/D;IAEA,MAEME,QAAQ,AAAsBC,SAAoB,EAAE;QACtD,OAAO,IAAI,CAACC,iCAAiC,CAACV,OAAO,CAACS;IAC1D;IAEA,MAEME,aAAa,AAAaC,oBAA4B,EAAE,AAAYhB,QAAmB,EAAE;QAC3F,OAAO,MAAM,IAAI,CAACiB,sCAAsC,CAACb,OAAO,CAAC;YAC7DY;YACAX,cAAcL,SAASM,QAAQ;QACnC;IACJ;IA9CAY,YACI,AAAiBf,gCAAiE,EAClF,AAAiBW,iCAAmE,EACpF,AAAiBN,gCAAiE,EAClF,AAAiBG,gCAAiE,EAClF,AAAiBM,sCAA6E,CAChG;aALmBd,mCAAAA;aACAW,oCAAAA;aACAN,mCAAAA;aACAG,mCAAAA;aACAM,yCAAAA;IAClB;AAyCP;;;6CAtCyBE;;;;;;;;;;;;;gEAWAC;6CACAC;;;;;;;;;;;6CAOAA;;;;;;;;;;6CAMAA;;;;;;;;;;6CAMAA;;;;;;;;;;;;gEA5CJC,6BAAeF;;QACtBG,MAAM;QAAwBC,SAAS"}