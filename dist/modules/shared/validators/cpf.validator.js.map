{"version":3,"sources":["../../../../src/modules/shared/validators/cpf.validator.ts"],"sourcesContent":["import { registerDecorator, ValidationOptions, ValidatorConstraint, ValidatorConstraintInterface } from 'class-validator';\r\n\r\n@ValidatorConstraint({ async: false })\r\nexport class IsCpfConstraint implements ValidatorConstraintInterface {\r\n  validate(cpf: string) {\r\n    cpf = cpf.replace(/[^\\d]+/g, ''); \r\n\r\n    if (cpf.length !== 11 || /^(\\d)\\1{10}$/.test(cpf)) return false;\r\n\r\n    let sum = 0;\r\n    let remainder: number;\r\n\r\n    for (let i = 1; i <= 9; i++) {\r\n      sum += parseInt(cpf.charAt(i - 1)) * (11 - i);\r\n    }\r\n\r\n    remainder = (sum * 10) % 11;\r\n    if (remainder === 10 || remainder === 11) remainder = 0;\r\n    if (remainder !== parseInt(cpf.charAt(9))) return false;\r\n\r\n    sum = 0;\r\n    for (let i = 1; i <= 10; i++) {\r\n      sum += parseInt(cpf.charAt(i - 1)) * (12 - i);\r\n    }\r\n\r\n    remainder = (sum * 10) % 11;\r\n    if (remainder === 10 || remainder === 11) remainder = 0;\r\n    return remainder === parseInt(cpf.charAt(10));\r\n  }\r\n\r\n  defaultMessage() {\r\n    return 'Invalid CPF';\r\n  }\r\n}\r\n\r\nexport function IsCpf(validationOptions?: ValidationOptions) {\r\n  return function (object: any, propertyName: string) {\r\n    registerDecorator({\r\n      target: object.constructor,\r\n      propertyName,\r\n      options: validationOptions,\r\n      constraints: [],\r\n      validator: IsCpfConstraint,\r\n    });\r\n  };\r\n}\r\n"],"names":["IsCpf","IsCpfConstraint","validate","cpf","replace","length","test","sum","remainder","i","parseInt","charAt","defaultMessage","async","validationOptions","object","propertyName","registerDecorator","target","constructor","options","constraints","validator"],"mappings":";;;;;;;;;;;IAmCgBA,KAAK;eAALA;;IAhCHC,eAAe;eAAfA;;;gCAH2F;;;;;;;AAGjG,IAAA,AAAMA,kBAAN,MAAMA;IACXC,SAASC,GAAW,EAAE;QACpBA,MAAMA,IAAIC,OAAO,CAAC,WAAW;QAE7B,IAAID,IAAIE,MAAM,KAAK,MAAM,eAAeC,IAAI,CAACH,MAAM,OAAO;QAE1D,IAAII,MAAM;QACV,IAAIC;QAEJ,IAAK,IAAIC,IAAI,GAAGA,KAAK,GAAGA,IAAK;YAC3BF,OAAOG,SAASP,IAAIQ,MAAM,CAACF,IAAI,MAAO,CAAA,KAAKA,CAAAA;QAC7C;QAEAD,YAAY,AAACD,MAAM,KAAM;QACzB,IAAIC,cAAc,MAAMA,cAAc,IAAIA,YAAY;QACtD,IAAIA,cAAcE,SAASP,IAAIQ,MAAM,CAAC,KAAK,OAAO;QAElDJ,MAAM;QACN,IAAK,IAAIE,IAAI,GAAGA,KAAK,IAAIA,IAAK;YAC5BF,OAAOG,SAASP,IAAIQ,MAAM,CAACF,IAAI,MAAO,CAAA,KAAKA,CAAAA;QAC7C;QAEAD,YAAY,AAACD,MAAM,KAAM;QACzB,IAAIC,cAAc,MAAMA,cAAc,IAAIA,YAAY;QACtD,OAAOA,cAAcE,SAASP,IAAIQ,MAAM,CAAC;IAC3C;IAEAC,iBAAiB;QACf,OAAO;IACT;AACF;;;QA/BuBC,OAAO;;;AAiCvB,SAASb,MAAMc,iBAAqC;IACzD,OAAO,SAAUC,MAAW,EAAEC,YAAoB;QAChDC,IAAAA,iCAAiB,EAAC;YAChBC,QAAQH,OAAOI,WAAW;YAC1BH;YACAI,SAASN;YACTO,aAAa,EAAE;YACfC,WAAWrB;QACb;IACF;AACF"}